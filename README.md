![CI](https://github.com/yg1112/Tuna/actions/workflows/ci.yml/badge.svg)

# Tuna - 音频转写与设备管理工具

Tuna是一款功能强大的macOS应用，专为音频转写和设备管理而设计。它允许用户通过全局快捷键快速开启语音转写，管理音频设备，并提供高效的用户界面。

## 📋 主要功能

- **快速听写**: 通过全局快捷键随时随地启动语音转写
- **可编辑转写**: V1.1新增功能，支持手动编辑转写结果，修正不准确内容
- **音频设备管理**: 方便地切换和控制系统音频设备
- **全局快捷键**: 自定义全局快捷键以触发应用功能
- **格式化工具**: 格式化转写文本，如首字母大写和句子优化
- **右键菜单**: 丰富的上下文菜单提供更多文本操作选项

## ⚙️ 系统要求

- macOS 13.0 或更高版本
- 支持Apple Silicon和Intel芯片

## 🚀 安装

1. 下载最新版本的Tuna.app
2. 将应用拖动到Applications文件夹
3. 首次运行时，系统可能会要求授权麦克风和辅助功能权限
4. 按照应用内提示完成初始设置

## 📘 使用指南

### 快捷键设置

1. 打开Tuna应用设置
2. 导航到"快捷键"选项卡
3. 为"快速听写"功能设置所需快捷键（默认为cmd+u）
4. 保存设置

### 语音转写与编辑

1. 在任何应用中按下设置的快捷键
2. 快速听写窗口将会显示
3. 开始说话，系统会自动录制您的语音
4. 点击"停止"按钮结束录制
5. 转写结果会显示在窗口中
6. **新功能**: 直接点击转写文本进行编辑，右键点击可以使用更多文本操作

## 🛠 开发指南

### 开发环境设置

1. 克隆仓库
2. 运行 `make bootstrap` 安装必要工具
3. 运行 `make test` 确保所有测试通过

### 测试要求

项目包含多层测试保障：

1. **UI组件测试**
   - ViewInspector 覆盖所有设置标签页的存在性与默认展开状态：
     - General: Launch、Updates 卡片
     - Dictation: Shortcut、Magic Transform、Engine、Transcription Output 卡片
     - Audio: Smart Swaps、Audio Devices 卡片
     - Appearance: Theme、Appearance 卡片
     - Advanced: Beta Features、Debug 卡片
     - Support: About 卡片
   - 确保所有卡片默认为展开状态
   - 验证卡片展开状态的持久化

2. **数据持久化测试**
   - DirectoryPersistenceTests 使用临时目录验证：
     - 转写输出目录 URL 的保存和读取
     - URL round-trip 测试（写入后重新读取）
     - 目录设置在重启后保持一致
     - 卡片展开状态的持久化
     - UserDefaults 同步验证

3. **快照测试**
   - UI更改必须更新相关快照
   - 运行 `make snapshot` 更新快照

4. **代码质量检查**
   - SwiftFormat格式化检查
   - YAML文件语法检查
   - 构建验证

### 提交工作流

每次提交前必须通过以下检查：

```bash
make lint      # 运行代码格式化检查
make snapshot  # 更新UI快照
make test      # 运行所有测试
```

### CI/CD

- GitHub Actions自动运行所有测试
- 主分支受保护，需要通过所有CI检查
- PR必须至少有一个审阅者批准

## 📝 版本历史

### V1.1 (2025-04-16)
- ✨ **新功能**: 听写文本输出框可编辑，用户可以手动修改语音转文本结果
- 🔧 添加文本格式化功能（首字母大写、句子格式优化）
- 📋 增强上下文菜单，提供更多文本操作选项
- 🔔 添加编辑提示标签

### V1.0 (2025-04-01)
- 初始版本发布
- 快速听写功能
- 全局快捷键支持
- 音频设备管理

## 📚 文档

更多详细文档，请参阅:
- [AudioBuddy功能指南](docs/AudioBuddyGuide.md)

## 🔑 许可证

此项目基于MIT许可证发布。 

