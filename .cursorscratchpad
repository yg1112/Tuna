# Tuna Project Development Tracking

## Module: TunaApp
- Status: in-progress
- Created: 2024-03-21
- Last Updated: 2024-03-21

### Tasks
- [ ] UI Components
  - [ ] MenuBarView implementation
  - [ ] TabRouter setup
  - [ ] Settings UI with NEW_SETTINGS_UI flag support
- [ ] Audio Device Management
  - [ ] Device enumeration and control
  - [ ] Volume/Balance control implementation
  - [ ] Bluetooth device support
- [ ] Transcription Service
  - [ ] Audio capture setup
  - [ ] Speech recognition integration
  - [ ] Text output and formatting
- [ ] Global Shortcuts
  - [ ] Quick dictation trigger
  - [ ] Device control shortcuts
- [ ] Testing
  - [ ] ViewInspector tests
  - [ ] Snapshot tests
  - [ ] MenuBarPopover tests

### Current Progress
- Initial project setup complete with Package.swift configuration
- Basic audio device management implementation started
- Test framework integration with ViewInspector and SnapshotTesting

### Files and Dependencies
- Core Files:
  - Sources/Tuna/AudioDevice.swift
  - Sources/Tuna/MenuBarView.swift
  - Sources/Tuna/TabRouter.swift
- Test Files:
  - Tests/TunaTests/*
  - Tests/MenuBarPopoverTests/*
- Dependencies:
  - swift-snapshot-testing: v1.18.3
  - ViewInspector: v0.10.1

### Manual Verification Checklist
- [ ] Build passes: `swift build`
- [ ] Tests pass: `swift test`
- [ ] UI renders correctly
- [ ] Audio device controls work
- [ ] Global shortcuts register and trigger
- [ ] Transcription works end-to-end

### Development Status
- Branch: main
- Build Status: âœ… Passing
- Test Status: ðŸŸ¡ Partial (new tests needed)
- Next Steps:
  1. Complete AudioDevice.swift implementation
  2. Add MenuBarView UI components
  3. Implement transcription service
  4. Add comprehensive tests

### Notes
- Using macOS 13.0+ as target platform
- NEW_SETTINGS_UI feature flag enabled
- Supporting both Apple Silicon and Intel chips
- Accessibility permissions required for global shortcuts 

## Module: CollapsibleCard
Status: Ready for Commit
Build Status: Passed
Manual Verification: Completed

Changes Made:
- Simplified component structure
- Added accessibility identifier
- Improved testability
- Added unit tests
- Removed debug prints
- Made properties immutable where possible

Modified Files:
- Sources/Tuna/Views/Components/CollapsibleCard.swift
- Tests/TunaTests/DictationSettingsViewTests.swift

Verification Results:
- Component renders correctly
- Expansion/collapse works
- Accessibility identifier present
- Tests pass

Completed: 2024-03-21 

## Module: TunaSettingsView
===================

STATUS
------
Current: In Progress
Build: Passed
Verification: Partial
Last Updated: 2024-03-21

SECTIONS
--------
General
Dictation
Audio
Appearance
Advanced
Support

COMPLETED
---------
* Sidebar navigation
* CollapsibleCard components
* Theme system integration
* Settings persistence
* Build verification
* Basic navigation testing
* Settings persistence testing
* Theme application testing

PENDING
-------
* Complete manual testing
* Accessibility improvements
* Full accessibility audit
* Complete test coverage
* Add remaining test cases
* Add keyboard navigation
* Complete documentation

FILES MODIFIED
-------------
* Sources/Tuna/TunaSettingsView.swift
* Sources/Tuna/Views/Components/CollapsibleCard.swift
* Sources/Tuna/DesignTokens.swift
* Tests/TunaTests/TunaSettingsUITests.swift

END MODULE 

modules:
  DictationSettingsPage:
    status: ready_for_commit
    build_status: passed
    manual_verification: completed
    invariants:
      - four_cards_present
      - explicit_self_rule_active
      - cards_default_open
    changes:
      - Added Engine card with API key input
      - Added Transcription Output card with format selection
      - Added output directory picker with Browse button
      - Made all cards default to expanded state
      - Updated tests to verify card presence and expansion
      - Added DirectoryPersistenceTests
    files_modified:
      - Sources/Tuna/TunaSettings.swift
      - Sources/Tuna/TunaSettingsView.swift
      - Tests/TunaTests/SettingsPresenceTests.swift
      - Tests/TunaTests/DisclosureGroupTests.swift
      - Tests/TunaTests/DirectoryPersistenceTests.swift
      - README.md
    verification:
      build: passed
      tests: passed
      ui_cards: present
      yaml_lint: passed
      directory_picker: functional
      persistence: verified 

## Module: CollapsibleCards
Status: Complete
Last Updated: 2024-03-21

Changes Made:
- Made all cards non-collapsible in TunaSettingsView and DictationSettingsView
- Set collapsible: false for all CollapsibleCard instances
- Affected components: Launch on Startup, Check for Updates, Shortcut, Engine, etc.

Modified Files:
- Sources/Tuna/TunaSettingsView.swift
- Sources/Tuna/DictationSettingsView.swift

Verification:
- Build Status: Passed
- Manual Check: Cards remain expanded and non-collapsible
- UI Consistency: Maintained across all settings views 

## Module: DictationSettingsView
Status: Completed
Last Updated: 2024-03-21

Changes Made:
- Updated all CollapsibleCard components to be non-collapsible
- Removed chevron icons from all cards
- Added test to verify no chevrons are present
- Modified files:
  - Sources/Tuna/DictationSettingsView.swift
  - Tests/TunaTests/DisclosureGroupTests.swift

Verification:
- Build Status: Passed
- Manual Testing: Completed
  - All settings sections remain expanded
  - No chevron icons visible across all cards
  - Accessibility and navigation working as expected

## Previous Entries
// ... existing code ... 